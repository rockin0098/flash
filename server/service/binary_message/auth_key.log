➜  flash git:(dev) ✗ go run GateServer/main.go
[2018-10-08 19:45:09.329]  INFO logger init (logger.LogInit:logger.go:55)
[2018-10-08 19:45:09.330]  INFO ############################################# (gateserver.GateEntry:gate_server.go:21)
[2018-10-08 19:45:09.330]  INFO ################ GateServer ################# (gateserver.GateEntry:gate_server.go:22)
[2018-10-08 19:45:09.331]  INFO ############################################# (gateserver.GateEntry:gate_server.go:23)
[2018-10-08 19:45:09.331]  INFO TCP server listening at :5222 (gateserver.(*TTcpServer).Run:tcp_server.go:27)
[2018-10-08 19:45:09.331]  INFO keep main func here ... ... (gateserver.GateEntry:gate_server.go:38)
[2018-10-08 19:45:14.342] DEBUG s:[:5222] accept connection from 10.30.0.28:59473 (gateserver.(*TTcpServer).Run:tcp_server.go:41)
[2018-10-08 19:45:14.344] DEBUG s:[:5222] accept connection from 10.30.0.28:59474 (gateserver.(*TTcpServer).Run:tcp_server.go:41)
[2018-10-08 19:45:14.345] DEBUG entering... (mtproto.(*MTProto).selectCodec:mtproto.go:161)
[2018-10-08 19:45:14.345] DEBUG entering... (mtproto.(*MTProto).selectCodec:mtproto.go:161)
[2018-10-08 19:45:14.345] DEBUG b_0_1 : a8 (mtproto.(*MTProto).selectCodec:mtproto.go:170)
[2018-10-08 19:45:14.345] DEBUG 1.b_1_3 : 06bf8b (mtproto.(*MTProto).selectCodec:mtproto.go:188)
[2018-10-08 19:45:14.345] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.345]  INFO first_byte: 0a (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:513)
[2018-10-08 19:45:14.345]  INFO first_byte2: 0a (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:518)
[2018-10-08 19:45:14.345]  INFO size1: 40 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:522)
[2018-10-08 19:45:14.348] DEBUG sessid = 10002, message.Payload = 0000000000000000aecdea56a7d63f26140000007897466029fc0bebbcc7178a11e957f11b1b68f5 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:562)
[2018-10-08 19:45:14.348] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.348]  INFO entering.......sessid=10002, TransportType = 1, AuthKeyID = 0, QuickAckID = 0, Payload =
0000000000000000aecdea56a7d63f26140000007897466029fc0bebbcc7178a11e957f11b1b68f5
 (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:16)
[2018-10-08 19:45:14.348]  INFO UnencryptedMessage decode = aecdea56a7d63f26140000007897466029fc0bebbcc7178a11e957f11b1b68f5 (mtproto.(*UnencryptedMessage).Decode:mtp_message.go:188)
[2018-10-08 19:45:14.348] DEBUG TLObject - classID: 60469778, className: TL_CLASS_req_pq (mtproto.(*MTPDecodeBuffer).TLObject:mtp_decode.go:331)
[2018-10-08 19:45:14.351] DEBUG class type = *mtproto.TL_req_pq (service.(*LProtoService).MTProtoUnencryptedMessageProcess:lproto_mtproto_service.go:71)
[2018-10-08 19:45:14.351]  INFO entering... sessid = 10002 (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:21)
[2018-10-08 19:45:14.352]  INFO nonce = 29fc0bebbcc7178a11e957f11b1b68f5 (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:30)
[2018-10-08 19:45:14.352] DEBUG before sessid = 10002, mtp = 0xc0000fc0f0, state = &{State:0 Nonce:[] ServerNonce:[] NewNonce:[] A:[] P:[] AuthKeyID:0 AuthKey:[]} (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:48)
[2018-10-08 19:45:14.352] DEBUG after sessid = 10002, mtp = 0xc0000fc0f0, state = &{State:0 Nonce:[41 252 11 235 188 199 23 138 17 233 87 241 27 27 104 245] ServerNonce:[129 24 160 227 4 134 234 191 0 114 203 62 51 102 34 25] NewNonce:[] A:[] P:[] AuthKeyID:0 AuthKey:[]} (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:57)
[2018-10-08 19:45:14.355] DEBUG sessid = 10002, resp payload = 0000000000000000b9f72b154a43bb5b400000006324160529fc0bebbcc7178a11e957f11b1b68f58118a0e30486eabf0072cb3e336622190817ed48941a08f98100000015c4b51c01000000cd601077c171e0a9 (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:40)
[2018-10-08 19:45:14.355] DEBUG entering... (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:737)
[2018-10-08 19:45:14.355] DEBUG mtproto app write = d4a8038c0368804326c0135496009ee5af0cf89688e8fee884e2795bfdd5e5304e688be98408725ee46695b2ab2ad1f75d2385f6069a83bfd53729dde65d1bace7bed956f4b139d0948d6b8d7ad443418f6f735d10 (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:761)
[2018-10-08 19:45:14.350] DEBUG b_0_1 : 6e (mtproto.(*MTProto).selectCodec:mtproto.go:170)
[2018-10-08 19:45:14.356] DEBUG 1.b_1_3 : 7e9e30 (mtproto.(*MTProto).selectCodec:mtproto.go:188)
[2018-10-08 19:45:14.360] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.360]  INFO first_byte: 0a (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:513)
[2018-10-08 19:45:14.360]  INFO first_byte2: 0a (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:518)
[2018-10-08 19:45:14.360]  INFO size1: 40 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:522)
[2018-10-08 19:45:14.360] DEBUG sessid = 10004, message.Payload = 000000000000000000c81f584a43bb5b14000000789746608ce89da80cb6a4f7f5016ff4cb21fb04 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:562)
[2018-10-08 19:45:14.359]  WARN read stream first byte failed, err = EOF (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:509)
[2018-10-08 19:45:14.361]  WARN s:[:5222], remote: 10.30.0.28:59473, sess = 10002,connection error: EOF (gateserver.(*TTcpServer).ConnectionHandler.func2:tcp_server.go:95)
[2018-10-08 19:45:14.366]  WARN recieved from close channel, will close the connection, sessid = 10002 (gateserver.(*TTcpServer).ConnectionHandler.func3:tcp_server.go:126)
[2018-10-08 19:45:14.366] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.366]  INFO entering.......sessid=10004, TransportType = 1, AuthKeyID = 0, QuickAckID = 0, Payload =
000000000000000000c81f584a43bb5b14000000789746608ce89da80cb6a4f7f5016ff4cb21fb04
 (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:16)
[2018-10-08 19:45:14.367]  INFO UnencryptedMessage decode = 00c81f584a43bb5b14000000789746608ce89da80cb6a4f7f5016ff4cb21fb04 (mtproto.(*UnencryptedMessage).Decode:mtp_message.go:188)
[2018-10-08 19:45:14.367] DEBUG TLObject - classID: 60469778, className: TL_CLASS_req_pq (mtproto.(*MTPDecodeBuffer).TLObject:mtp_decode.go:331)
[2018-10-08 19:45:14.367] DEBUG class type = *mtproto.TL_req_pq (service.(*LProtoService).MTProtoUnencryptedMessageProcess:lproto_mtproto_service.go:71)
[2018-10-08 19:45:14.368]  INFO entering... sessid = 10004 (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:21)
[2018-10-08 19:45:14.368]  INFO nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04 (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:30)
[2018-10-08 19:45:14.368] DEBUG before sessid = 10004, mtp = 0xc000254000, state = &{State:0 Nonce:[] ServerNonce:[] NewNonce:[] A:[] P:[] AuthKeyID:0 AuthKey:[]} (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:48)
[2018-10-08 19:45:14.368] DEBUG after sessid = 10004, mtp = 0xc000254000, state = &{State:0 Nonce:[140 232 157 168 12 182 164 247 245 1 111 244 203 33 251 4] ServerNonce:[138 237 139 247 94 90 6 200 41 230 60 115 242 148 32 189] NewNonce:[] A:[] P:[] AuthKeyID:0 AuthKey:[]} (service.(*LProtoService).TL_req_pq_Process:unencrypted_message_service.go:57)
[2018-10-08 19:45:14.368] DEBUG sessid = 10004, resp payload = 00000000000000005998f9154a43bb5b40000000632416058ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bd0817ed48941a08f98100000015c4b51c01000000cd601077c171e0a9 (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:40)
[2018-10-08 19:45:14.368] DEBUG entering... (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:737)
[2018-10-08 19:45:14.368] DEBUG mtproto app write = b476985a666e665400f3b81762aab58e8cd597bfbd97d7d20cec1baf0b1564e41403a5c2bb4340af0045843709a1e93c124d1f4a0d982f27c3a506994c50d5b60ebf4eab0419c7ffe634cfbb2d507ee02efad02b84 (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:761)
[2018-10-08 19:45:14.499]  INFO first_byte: 55 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:513)
[2018-10-08 19:45:14.499]  INFO first_byte2: 55 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:518)
[2018-10-08 19:45:14.499]  INFO size1: 340 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:522)
[2018-10-08 19:45:14.499] DEBUG sessid = 10004, message.Payload = 00000000000000000070cb7f4a43bb5b40010000bee412d78ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bd04494c553b0000000453911073000000cd601077c171e0a9fe0001007b72a7738ead0cefa0cb35218da24906d83e7c15828b472c4dde6ecdd1644f2a80775b2793b9d74d2b115304f3b08d99d9f5c034f8281285fc2eac146cafc78fb4da34ba5daf061b47b60ddebb7d3dd0afcc66ee3fae8dfef479765a0f4ce65e197b2ab8e6b84a4893dd3856bc57d44d33de88969ddb4bdbf8014ca4f56acd9c7c8254d9dd05bbb6f988ac889ff31cd92173aa8ef78dc2d0b101f37d65b814f88428d4902f36d80f001cb79c92d007814ceac4b1208510a5d6df2ee39556225d0732ba76a7d251e6c6e4b66574eea541b492d5e5b1b05cd052c7f801eb5eb8ca47fb0adee2872af2f0e1fc233337f8cea21c4354332e89968af0a518609f6016 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:562)
[2018-10-08 19:45:14.500] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.500]  INFO entering.......sessid=10004, TransportType = 1, AuthKeyID = 0, QuickAckID = 0, Payload =
00000000000000000070cb7f4a43bb5b40010000bee412d78ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bd04494c553b0000000453911073000000cd601077c171e0a9fe0001007b72a7738ead0cefa0cb35218da24906d83e7c15828b472c4dde6ecdd1644f2a80775b2793b9d74d2b115304f3b08d99d9f5c034f8281285fc2eac146cafc78fb4da34ba5daf061b47b60ddebb7d3dd0afcc66ee3fae8dfef479765a0f4ce65e197b2ab8e6b84a4893dd3856bc57d44d33de88969ddb4bdbf8014ca4f56acd9c7c8254d9dd05bbb6f988ac889ff31cd92173aa8ef78dc2d0b101f37d65b814f88428d4902f36d80f001cb79c92d007814ceac4b1208510a5d6df2ee39556225d0732ba76a7d251e6c6e4b66574eea541b492d5e5b1b05cd052c7f801eb5eb8ca47fb0adee2872af2f0e1fc233337f8cea21c4354332e89968af0a518609f6016
 (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:16)
[2018-10-08 19:45:14.500]  INFO UnencryptedMessage decode = 0070cb7f4a43bb5b40010000bee412d78ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bd04494c553b0000000453911073000000cd601077c171e0a9fe0001007b72a7738ead0cefa0cb35218da24906d83e7c15828b472c4dde6ecdd1644f2a80775b2793b9d74d2b115304f3b08d99d9f5c034f8281285fc2eac146cafc78fb4da34ba5daf061b47b60ddebb7d3dd0afcc66ee3fae8dfef479765a0f4ce65e197b2ab8e6b84a4893dd3856bc57d44d33de88969ddb4bdbf8014ca4f56acd9c7c8254d9dd05bbb6f988ac889ff31cd92173aa8ef78dc2d0b101f37d65b814f88428d4902f36d80f001cb79c92d007814ceac4b1208510a5d6df2ee39556225d0732ba76a7d251e6c6e4b66574eea541b492d5e5b1b05cd052c7f801eb5eb8ca47fb0adee2872af2f0e1fc233337f8cea21c4354332e89968af0a518609f6016 (mtproto.(*UnencryptedMessage).Decode:mtp_message.go:188)
[2018-10-08 19:45:14.500] DEBUG TLObject - classID: d712e4be, className: TL_CLASS_req_DH_params (mtproto.(*MTPDecodeBuffer).TLObject:mtp_decode.go:331)
[2018-10-08 19:45:14.500] DEBUG class type = *mtproto.TL_req_DH_params (service.(*LProtoService).MTProtoUnencryptedMessageProcess:lproto_mtproto_service.go:71)
[2018-10-08 19:45:14.500]  INFO entering... sessid = 10004 (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:63)
[2018-10-08 19:45:14.500] DEBUG before2 sessid = 10004, mtp = 0xc000254000, state = &{State:0 Nonce:[140 232 157 168 12 182 164 247 245 1 111 244 203 33 251 4] ServerNonce:[138 237 139 247 94 90 6 200 41 230 60 115 242 148 32 189] NewNonce:[] A:[] P:[] AuthKeyID:0 AuthKey:[]} (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:71)
[2018-10-08 19:45:14.500]  INFO tl.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04, state.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04 (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:79)
[2018-10-08 19:45:14.500]  INFO tl.server_nonce = 8aed8bf75e5a06c829e63c73f29420bd, state.ServerNonce = 8aed8bf75e5a06c829e63c73f29420bd (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:82)
[2018-10-08 19:45:14.500]  INFO tl.p = 494c553b, state.p = 494c553b (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:85)
[2018-10-08 19:45:14.500]  INFO tl.q = 53911073, state.q = 53911073 (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:88)
[2018-10-08 19:45:14.501]  INFO tl.fingerprint = -6205835210776354611, state.fingerprint = -6205835210776354611 (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:91)
[2018-10-08 19:45:14.506]  INFO pqInnerData.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04, state.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04 (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:122)
[2018-10-08 19:45:14.507]  INFO pqInnerData.server_nonce = 8aed8bf75e5a06c829e63c73f29420bd, state.ServerNonce = 8aed8bf75e5a06c829e63c73f29420bd (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:125)
[2018-10-08 19:45:14.507]  INFO pqInnerData.p = 494c553b, state.p = 494c553b (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:128)
[2018-10-08 19:45:14.507]  INFO pqInnerData.q = 53911073, state.q = 53911073 (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:131)
[2018-10-08 19:45:14.507]  INFO pqInnerData.pq = [23 237 72 148 26 8 249 129], state.pq = [23 237 72 148 26 8 249 129] (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:134)
[2018-10-08 19:45:14.507] DEBUG after2 sessid = 10004, mtp = 0xc000254000, state = &{State:0 Nonce:[140 232 157 168 12 182 164 247 245 1 111 244 203 33 251 4] ServerNonce:[138 237 139 247 94 90 6 200 41 230 60 115 242 148 32 189] NewNonce:[56 136 103 209 209 11 242 236 10 51 118 70 66 193 42 141 167 80 50 94 215 247 102 98 226 159 149 238 6 180 179 111] A:[103 95 111 83 7 195 146 226 174 105 16 160 129 132 121 113 204 71 49 112 39 75 143 208 162 84 6 120 23 38 29 90 217 207 182 43 144 16 35 125 41 38 227 131 141 143 19 201 82 4 166 253 169 58 135 203 117 105 17 218 203 172 174 201 107 201 28 101 24 174 220 227 252 77 32 40 110 27 95 196 93 7 14 71 75 226 52 29 105 21 106 180 122 11 146 148 246 142 221 104 50 114 188 169 20 147 215 99 255 1 67 112 82 17 198 56 88 166 221 173 66 224 152 57 183 90 120 129 244 138 18 64 38 235 165 114 160 8 1 1 91 130 63 52 17 138 110 153 254 94 13 127 228 89 111 179 165 104 247 48 110 31 142 242 247 247 221 33 232 112 183 213 86 240 207 81 218 238 126 28 217 231 216 129 228 251 54 84 61 230 219 188 240 17 151 137 149 170 77 155 91 144 15 58 156 157 219 69 33 135 17 218 48 134 32 216 118 190 251 130 150 46 185 4 80 242 93 156 163 123 8 92 59 30 140 254 243 251 231 240 176 227 216 173 131 241 11 72 61 147 147 104 128 64 109 41] P:[199 28 174 185 198 177 201 4 142 108 82 47 112 241 63 115 152 13 64 35 142 62 33 193 73 52 208 55 86 61 147 15 72 25 138 10 167 193 64 88 34 148 147 210 37 48 244 219 250 51 111 110 10 201 37 19 149 67 174 212 76 206 124 55 32 253 81 246 148 88 112 90 198 140 212 254 107 107 19 171 220 151 70 81 41 105 50 132 84 241 143 175 140 89 95 100 36 119 254 150 187 42 148 29 91 205 29 74 200 204 73 136 7 8 250 155 55 142 60 79 58 144 96 190 230 124 249 164 164 166 149 129 16 81 144 126 22 39 83 181 107 15 107 65 13 186 116 216 168 75 42 20 179 20 78 14 241 40 71 84 253 23 237 149 13 89 101 180 185 221 70 88 45 177 23 141 22 156 107 196 101 176 214 255 156 163 146 143 239 91 154 228 228 24 252 21 232 62 190 160 248 127 169 255 94 237 112 5 13 237 40 73 244 123 249 89 217 86 133 12 233 41 133 31 13 129 21 246 53 177 5 238 46 78 21 208 75 36 84 191 111 79 173 240 52 177 4 3 17 156 216 227 185 47 204 91] AuthKeyID:0 AuthKey:[]} (service.(*LProtoService).TL_req_DH_params_Process:unencrypted_message_service.go:141)
[2018-10-08 19:45:14.515] DEBUG sessid = 10004, resp payload = 00000000000000002953bb1e4a43bb5b780200005c07e8d08ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bdfe5002004121a6351e894555d7f07b7de41518e86e74f7b3adb3b8f51f9ed28cd786dad41368d775d50432cfe6a590394aa0620b05efdb8eec7c7730f20607efb6cef1dded0646213ce5a8b401862c887723b07c7a7095dc1677666c1a17cce092c802ca3f6784080c9cfe4bd2f6621aad2a867a306f7d9541ce19c36381a44a4f4ee299d8032b941e9d8b3480ca1538391c8bd1def585bc6e8f8e9f8c293119c72164bb5efc31bcf8970ddcc776887b38667a728976b426aa353daddb537b2006b109389f289c875152658c13c110b2f7d42d71a0dd9af2e43a66bbefe5756b161270d720ecfd40886184885f2d6e6a16f9aa2cb9a398f697bc0ebafa647a61e6e630b6b1a44da27450fb664d5d396bbaf6841124c6126f737e8787c98cf376dbc7683128a860fbe26e0d4b29dece971e0d61110e71dd7ab11b233e6426aa5530504c12e69fa415fe929226ab48c63c5d394b7f7635c34fefcbbdb2712d9298ccf8241956aad83d27091cee393298ba7795ffbbba539ae3bdc51a70b7a3d9f230194fa7b56ddeb88841025052ff8782f6e8f1de3865a813333d244ca76bf37983581e54aefab8f86cbf95d0ec25b8ac705ca0df785e752cee5f2e246ac2245a13a745e2452336af4de57a8834259fd1859da80dab90d8b7526ce5c3f22200eb82efade6e742c1ae9b65d54fd4142f37b4cc9be790217a0d2f4f4765b06b9e98a6338b90595ff5ff6ae50f853335e70c9cc74af9577855acc000279733da36a0a8867df9e381387aca59700fca9a7baea032e50f45f6af330fd2229580c979be9c2424b8269499dc14c59f3616b57bfb58ebe14a (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:40)
[2018-10-08 19:45:14.515] DEBUG entering... (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:737)
[2018-10-08 19:45:14.515] DEBUG mtproto app write = d4c2d61b7b0057ebf6f354841238a53659cbcd1faeff189891d816fdcbf810a124ee953504af74c954e0e8c0ce1f9a67877f9d4eac47dfda2d407d02bc8ff88b3af9f0a379e82a64c7619863302bcd649531722d2742a2210af40a6fbe9c7a6c0e1aaaf9f1c49cd71849fcb28a769e07f101759613885fcccf41ed3c922a8c4ba22fbded226f1e5c08b604795baa3833bedf6388db177541ab419dd2925bcee7e3260a6f1622a69d5f079b498befbc8fd6b7b71b7fad0bbcd90b7277d65ecd03505d6a3a9c981004f5f65eb17c02ac201524e98cf7a0a339a2058335f20c0f791758247962887b379f22af34218639ec09200f6468198d2fdefdbd9bbad5c333445c508b86f38b294aff22c72c6e3f1e6d37f1b8ca946ec4907f5db6ddff6902c45224ae740b8b07e8d833b7905b7e5bd7a2a6d602a728d7b5d9d605119d560f5d787a4750cd1c0a8452d89870e804cd19de59573509dc99ef833ce0c118c2e29a0878351ba49a7d2948d50fb030267d1a33a713c6f371ff66eb3ed2da437fb226f4100f7e8bbe3f069d1b0423a8aff2c20e582ba5b111c1176416eb076e82cb324f99e46a33e5174e39eea09c249edf88498fb6cb61e7594d76b0f2f1cb2017b07a3bb8d2eeca8e9cdeee455f0e2d21e67ae98e9a496d384a6bb6f004751596b9a707232686062828a2769d0b1e08e70f027a95aff9e286421bf53ab62890ac6a25a7c2e7f09d78e588264c94ec3c0c5ec52f875a3e4012254cb3becb37bcace5ba58c30de41a8143025135b8df5f931d8a8d126dcf4e2d24ad1d68c590951b58db2bce86b086e1e125375690bf9789a8d2a1871d4ecc015a4495e3d2d9a01f7d5cdc029904866dc4c76327519a3e0031aac12f34b63ab66d42ab9999d6c88f1523c89609d96e1f248159c389bdd583 (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:761)
[2018-10-08 19:45:14.541]  INFO first_byte: 63 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:513)
[2018-10-08 19:45:14.541]  INFO first_byte2: 63 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:518)
[2018-10-08 19:45:14.541]  INFO size1: 396 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:522)
[2018-10-08 19:45:14.541] DEBUG sessid = 10004, message.Payload = 0000000000000000008c698a4a43bb5b780100001f5f04f58ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bdfe5001000e5d0f3929fcdc2aa314f145e2651677599e6bc44abafb39dcb65ce2892169405b072df33737afa4abe070e62114b28a4dc38c8fa597e382b1288d5e2d586cc5f5937f24cd9498ff92cc4fc62c1ff906f720e9b398a0295595349fd52cb520b3a63e3801f1a5ebb74ad6a6bb0b89a97988c25e8090e094f8bc660a57734259421cad4e6b778b0154669677bbe47b56d15a66b2ae422ed58985b4089b4b174f2c1156a0398f3fa116077c4ef229a01321f57c4e566120bfa943a53675c8e347c918e79bb4ad1e482123d64fdff74535106b5e064361b8f0cb1fdec5456d09f1cec32d50629b4f555e9181b5e09cb7ca1cdf901a0b4e65a523864bc4d17ba8d2952a80a90c871a0b9133f7ee892c18e49c0c5381bb5fea8812091f720caeabc74a5768e674c5c19924b9c18d6a027162f17e999311d790389efecb23584298b0e0a001accec3b81ba6cbc704e2ad385c14 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:562)
[2018-10-08 19:45:14.541] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.541]  INFO entering.......sessid=10004, TransportType = 1, AuthKeyID = 0, QuickAckID = 0, Payload =
0000000000000000008c698a4a43bb5b780100001f5f04f58ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bdfe5001000e5d0f3929fcdc2aa314f145e2651677599e6bc44abafb39dcb65ce2892169405b072df33737afa4abe070e62114b28a4dc38c8fa597e382b1288d5e2d586cc5f5937f24cd9498ff92cc4fc62c1ff906f720e9b398a0295595349fd52cb520b3a63e3801f1a5ebb74ad6a6bb0b89a97988c25e8090e094f8bc660a57734259421cad4e6b778b0154669677bbe47b56d15a66b2ae422ed58985b4089b4b174f2c1156a0398f3fa116077c4ef229a01321f57c4e566120bfa943a53675c8e347c918e79bb4ad1e482123d64fdff74535106b5e064361b8f0cb1fdec5456d09f1cec32d50629b4f555e9181b5e09cb7ca1cdf901a0b4e65a523864bc4d17ba8d2952a80a90c871a0b9133f7ee892c18e49c0c5381bb5fea8812091f720caeabc74a5768e674c5c19924b9c18d6a027162f17e999311d790389efecb23584298b0e0a001accec3b81ba6cbc704e2ad385c14
 (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:16)
[2018-10-08 19:45:14.541]  INFO UnencryptedMessage decode = 008c698a4a43bb5b780100001f5f04f58ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bdfe5001000e5d0f3929fcdc2aa314f145e2651677599e6bc44abafb39dcb65ce2892169405b072df33737afa4abe070e62114b28a4dc38c8fa597e382b1288d5e2d586cc5f5937f24cd9498ff92cc4fc62c1ff906f720e9b398a0295595349fd52cb520b3a63e3801f1a5ebb74ad6a6bb0b89a97988c25e8090e094f8bc660a57734259421cad4e6b778b0154669677bbe47b56d15a66b2ae422ed58985b4089b4b174f2c1156a0398f3fa116077c4ef229a01321f57c4e566120bfa943a53675c8e347c918e79bb4ad1e482123d64fdff74535106b5e064361b8f0cb1fdec5456d09f1cec32d50629b4f555e9181b5e09cb7ca1cdf901a0b4e65a523864bc4d17ba8d2952a80a90c871a0b9133f7ee892c18e49c0c5381bb5fea8812091f720caeabc74a5768e674c5c19924b9c18d6a027162f17e999311d790389efecb23584298b0e0a001accec3b81ba6cbc704e2ad385c14 (mtproto.(*UnencryptedMessage).Decode:mtp_message.go:188)
[2018-10-08 19:45:14.541] DEBUG TLObject - classID: f5045f1f, className: TL_CLASS_set_client_DH_params (mtproto.(*MTPDecodeBuffer).TLObject:mtp_decode.go:331)
[2018-10-08 19:45:14.541] DEBUG class type = *mtproto.TL_set_client_DH_params (service.(*LProtoService).MTProtoUnencryptedMessageProcess:lproto_mtproto_service.go:71)
[2018-10-08 19:45:14.541]  INFO entering... sessid = 10004 (service.(*LProtoService).TL_set_client_DH_params_Process:unencrypted_message_service.go:196)
[2018-10-08 19:45:14.541] DEBUG before3 sessid = 10004, mtp = 0xc000254000, state = &{State:0 Nonce:[140 232 157 168 12 182 164 247 245 1 111 244 203 33 251 4] ServerNonce:[138 237 139 247 94 90 6 200 41 230 60 115 242 148 32 189] NewNonce:[56 136 103 209 209 11 242 236 10 51 118 70 66 193 42 141 167 80 50 94 215 247 102 98 226 159 149 238 6 180 179 111] A:[103 95 111 83 7 195 146 226 174 105 16 160 129 132 121 113 204 71 49 112 39 75 143 208 162 84 6 120 23 38 29 90 217 207 182 43 144 16 35 125 41 38 227 131 141 143 19 201 82 4 166 253 169 58 135 203 117 105 17 218 203 172 174 201 107 201 28 101 24 174 220 227 252 77 32 40 110 27 95 196 93 7 14 71 75 226 52 29 105 21 106 180 122 11 146 148 246 142 221 104 50 114 188 169 20 147 215 99 255 1 67 112 82 17 198 56 88 166 221 173 66 224 152 57 183 90 120 129 244 138 18 64 38 235 165 114 160 8 1 1 91 130 63 52 17 138 110 153 254 94 13 127 228 89 111 179 165 104 247 48 110 31 142 242 247 247 221 33 232 112 183 213 86 240 207 81 218 238 126 28 217 231 216 129 228 251 54 84 61 230 219 188 240 17 151 137 149 170 77 155 91 144 15 58 156 157 219 69 33 135 17 218 48 134 32 216 118 190 251 130 150 46 185 4 80 242 93 156 163 123 8 92 59 30 140 254 243 251 231 240 176 227 216 173 131 241 11 72 61 147 147 104 128 64 109 41] P:[199 28 174 185 198 177 201 4 142 108 82 47 112 241 63 115 152 13 64 35 142 62 33 193 73 52 208 55 86 61 147 15 72 25 138 10 167 193 64 88 34 148 147 210 37 48 244 219 250 51 111 110 10 201 37 19 149 67 174 212 76 206 124 55 32 253 81 246 148 88 112 90 198 140 212 254 107 107 19 171 220 151 70 81 41 105 50 132 84 241 143 175 140 89 95 100 36 119 254 150 187 42 148 29 91 205 29 74 200 204 73 136 7 8 250 155 55 142 60 79 58 144 96 190 230 124 249 164 164 166 149 129 16 81 144 126 22 39 83 181 107 15 107 65 13 186 116 216 168 75 42 20 179 20 78 14 241 40 71 84 253 23 237 149 13 89 101 180 185 221 70 88 45 177 23 141 22 156 107 196 101 176 214 255 156 163 146 143 239 91 154 228 228 24 252 21 232 62 190 160 248 127 169 255 94 237 112 5 13 237 40 73 244 123 249 89 217 86 133 12 233 41 133 31 13 129 21 246 53 177 5 238 46 78 21 208 75 36 84 191 111 79 173 240 52 177 4 3 17 156 216 227 185 47 204 91] AuthKeyID:0 AuthKey:[]} (service.(*LProtoService).TL_set_client_DH_params_Process:unencrypted_message_service.go:204)
[2018-10-08 19:45:14.541]  INFO tl.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04, state.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04 (service.(*LProtoService).TL_set_client_DH_params_Process:unencrypted_message_service.go:212)
[2018-10-08 19:45:14.541]  INFO tl.server_nonce = 8aed8bf75e5a06c829e63c73f29420bd, state.ServerNonce = 8aed8bf75e5a06c829e63c73f29420bd (service.(*LProtoService).TL_set_client_DH_params_Process:unencrypted_message_service.go:215)
[2018-10-08 19:45:14.542]  INFO client_DHInnerData.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04, state.nonce = 8ce89da80cb6a4f7f5016ff4cb21fb04 (service.(*LProtoService).TL_set_client_DH_params_Process:unencrypted_message_service.go:247)
[2018-10-08 19:45:14.542]  INFO client_DHInnerData.server_nonce = 8aed8bf75e5a06c829e63c73f29420bd, state.ServerNonce = 8aed8bf75e5a06c829e63c73f29420bd (service.(*LProtoService).TL_set_client_DH_params_Process:unencrypted_message_service.go:250)
[2018-10-08 19:45:14.548] DEBUG after3 sessid = 10004, mtp = 0xc000254000, state = &{State:0 Nonce:[140 232 157 168 12 182 164 247 245 1 111 244 203 33 251 4] ServerNonce:[138 237 139 247 94 90 6 200 41 230 60 115 242 148 32 189] NewNonce:[56 136 103 209 209 11 242 236 10 51 118 70 66 193 42 141 167 80 50 94 215 247 102 98 226 159 149 238 6 180 179 111] A:[103 95 111 83 7 195 146 226 174 105 16 160 129 132 121 113 204 71 49 112 39 75 143 208 162 84 6 120 23 38 29 90 217 207 182 43 144 16 35 125 41 38 227 131 141 143 19 201 82 4 166 253 169 58 135 203 117 105 17 218 203 172 174 201 107 201 28 101 24 174 220 227 252 77 32 40 110 27 95 196 93 7 14 71 75 226 52 29 105 21 106 180 122 11 146 148 246 142 221 104 50 114 188 169 20 147 215 99 255 1 67 112 82 17 198 56 88 166 221 173 66 224 152 57 183 90 120 129 244 138 18 64 38 235 165 114 160 8 1 1 91 130 63 52 17 138 110 153 254 94 13 127 228 89 111 179 165 104 247 48 110 31 142 242 247 247 221 33 232 112 183 213 86 240 207 81 218 238 126 28 217 231 216 129 228 251 54 84 61 230 219 188 240 17 151 137 149 170 77 155 91 144 15 58 156 157 219 69 33 135 17 218 48 134 32 216 118 190 251 130 150 46 185 4 80 242 93 156 163 123 8 92 59 30 140 254 243 251 231 240 176 227 216 173 131 241 11 72 61 147 147 104 128 64 109 41] P:[199 28 174 185 198 177 201 4 142 108 82 47 112 241 63 115 152 13 64 35 142 62 33 193 73 52 208 55 86 61 147 15 72 25 138 10 167 193 64 88 34 148 147 210 37 48 244 219 250 51 111 110 10 201 37 19 149 67 174 212 76 206 124 55 32 253 81 246 148 88 112 90 198 140 212 254 107 107 19 171 220 151 70 81 41 105 50 132 84 241 143 175 140 89 95 100 36 119 254 150 187 42 148 29 91 205 29 74 200 204 73 136 7 8 250 155 55 142 60 79 58 144 96 190 230 124 249 164 164 166 149 129 16 81 144 126 22 39 83 181 107 15 107 65 13 186 116 216 168 75 42 20 179 20 78 14 241 40 71 84 253 23 237 149 13 89 101 180 185 221 70 88 45 177 23 141 22 156 107 196 101 176 214 255 156 163 146 143 239 91 154 228 228 24 252 21 232 62 190 160 248 127 169 255 94 237 112 5 13 237 40 73 244 123 249 89 217 86 133 12 233 41 133 31 13 129 21 246 53 177 5 238 46 78 21 208 75 36 84 191 111 79 173 240 52 177 4 3 17 156 216 227 185 47 204 91] AuthKeyID:-8315255599807889892 AuthKey:[164 151 144 136 107 31 29 238 121 49 230 192 36 168 46 135 202 35 67 188 57 147 198 23 183 106 193 115 226 35 211 72 102 210 48 138 5 108 243 239 230 119 5 213 214 239 102 150 112 116 203 168 245 24 90 64 131 234 135 2 70 121 136 128 187 104 142 97 60 67 186 158 181 58 237 216 29 53 44 108 174 42 24 137 144 76 46 141 169 159 26 164 165 97 56 103 43 115 46 14 161 1 243 66 227 215 204 151 108 241 245 248 8 217 194 220 223 28 152 157 3 186 243 192 193 161 137 3 32 230 237 19 221 222 146 144 51 5 3 1 137 10 223 237 162 16 88 44 81 189 65 66 247 176 72 60 179 227 19 80 254 85 122 17 166 49 64 53 101 157 51 160 240 70 117 87 2 174 168 58 253 79 72 63 240 5 125 72 110 142 108 3 192 140 192 94 66 104 197 101 101 243 137 127 28 206 75 152 91 193 99 165 233 63 251 52 72 105 163 158 192 223 81 205 143 216 152 204 24 209 209 3 231 120 1 56 120 93 219 42 14 43 207 134 92 218 177 2 238 22 180 67 43 18 73 198]} (service.(*LProtoService).TL_set_client_DH_params_Process:unencrypted_message_service.go:283)
[2018-10-08 19:45:14.549] DEBUG sessid = 10004, resp payload = 000000000000000039bbb9204a43bb5b3400000034f7cb3b8ce89da80cb6a4f7f5016ff4cb21fb048aed8bf75e5a06c829e63c73f29420bdaa64ca2d04f7d0f1a678131e8255365d (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:40)
[2018-10-08 19:45:14.549] DEBUG entering... (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:737)
[2018-10-08 19:45:14.549] DEBUG mtproto app write = b3b97c7270ad27f7b0f014b900cf7225739dad1710f611ac5683f96b9e76452a208a12763fe7104deae36445ea55e442924ab9efa872c923e0d1ef37babfd4e31045fa9ca7da52b0fc (mtproto.(*MTProto).WriteMTProtoApp:mtproto.go:761)
[2018-10-08 19:45:14.553]  WARN read stream first byte failed, err = EOF (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:509)
[2018-10-08 19:45:14.553]  WARN s:[:5222], remote: 10.30.0.28:59474, sess = 10004,connection error: EOF (gateserver.(*TTcpServer).ConnectionHandler.func2:tcp_server.go:95)
[2018-10-08 19:45:14.553]  WARN resp channel closed, write routine will exit, sessid = 10004 (gateserver.(*TTcpServer).ConnectionHandler.func3:tcp_server.go:122)
[2018-10-08 19:45:14.555] DEBUG s:[:5222] accept connection from 10.30.0.28:59475 (gateserver.(*TTcpServer).Run:tcp_server.go:41)
[2018-10-08 19:45:14.555] DEBUG entering... (mtproto.(*MTProto).selectCodec:mtproto.go:161)
[2018-10-08 19:45:14.562] DEBUG b_0_1 : 4a (mtproto.(*MTProto).selectCodec:mtproto.go:170)
[2018-10-08 19:45:14.563] DEBUG 1.b_1_3 : 7ffcd6 (mtproto.(*MTProto).selectCodec:mtproto.go:188)
[2018-10-08 19:45:14.563] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.563]  INFO first_byte: 16 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:513)
[2018-10-08 19:45:14.563]  INFO first_byte2: 16 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:518)
[2018-10-08 19:45:14.563]  INFO size1: 88 (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:522)
[2018-10-08 19:45:14.563] DEBUG sessid = 10010, message.Payload = 1c7edf8c16479a8c8c750d17ad4cd74d6f123edd593bda3d1e278327c8c8a965992ff845f784b9bf33a916d29cc9682324bcdc72c3250db183126f269c8edb2006b0f873cfcc5e355c57e4b99aae4119998de11d31ce421c (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:562)
[2018-10-08 19:45:14.563]  INFO entering.......sessid=10010, TransportType = 1, AuthKeyID = -8315255599807889892, QuickAckID = 0, Payload =
1c7edf8c16479a8c8c750d17ad4cd74d6f123edd593bda3d1e278327c8c8a965992ff845f784b9bf33a916d29cc9682324bcdc72c3250db183126f269c8edb2006b0f873cfcc5e355c57e4b99aae4119998de11d31ce421c
 (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:16)
[2018-10-08 19:45:14.563] DEBUG entering... (mtproto.(*MTProto).ReadMTProtoApp:mtproto.go:498)
[2018-10-08 19:45:14.563] DEBUG client authKeyID = -8315255599807889892, authid = 0, authkey = [] (service.(*LProtoService).MTProtoMessageProcess:lproto_mtproto_service.go:50)
[2018-10-08 19:45:14.566] ERROR panic !!! err = runtime error: slice bounds out of range  (grmon.(*TGRMon).catchPanic:grmon.go:23)
goroutine 29 [running]:
runtime/debug.Stack(0x13d0500, 0xc0002d42c0, 0x1)
	/usr/local/go/src/runtime/debug/stack.go:24 +0xa7
github.com/rockin0098/flash/base/logger.(*Logger).logErrorPrintf(0xc0000bc030, 0xc0000eb540, 0x147abb1, 0x13, 0xc0000eb590, 0x1, 0x1)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/base/logger/logger.go:171 +0x15c
github.com/rockin0098/flash/base/logger.(*Logger).Errorf(0xc0000bc030, 0x147abb1, 0x13, 0xc0000eb590, 0x1, 0x1)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/base/logger/logger.go:210 +0x8a
github.com/rockin0098/flash/base/grmon.(*TGRMon).catchPanic(0x19210b8)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/base/grmon/grmon.go:23 +0x9b
panic(0x13d7600, 0x1921a80)
	/usr/local/go/src/runtime/panic.go:513 +0x1b9
github.com/rockin0098/flash/proto/mtproto.generateMessageKey(0xc0000960c8, 0x10, 0x50, 0x0, 0x0, 0x0, 0x300, 0xc2, 0x0, 0x0, ...)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/proto/mtproto/mtp_message.go:74 +0x6e6
github.com/rockin0098/flash/proto/mtproto.(*EncryptedMessage).decrypt(0xc0000ebd30, 0xc0000960c8, 0x10, 0x50, 0x0, 0x0, 0x0, 0xc0000960d8, 0x40, 0x40, ...)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/proto/mtproto/mtp_message.go:267 +0x89
github.com/rockin0098/flash/proto/mtproto.(*EncryptedMessage).Decode(0xc0000ebd30, 0x0, 0x0, 0x0, 0xc0000960c8, 0x50, 0x50, 0x1016370, 0x100cde0)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/proto/mtproto/mtp_message.go:230 +0xce
github.com/rockin0098/flash/server/service.(*LProtoService).MTProtoMessageProcess(0x1946c60, 0xc000452580, 0xc00042a570, 0x20, 0x140bcc0, 0x800000000000001, 0xc000056df8)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/server/service/lproto_mtproto_service.go:55 +0x8f6
github.com/rockin0098/flash/server/service.(*LProtoService).MessageProcess(0x1946c60, 0xc00000c040, 0xc000056f08, 0x105e089, 0x1929d00, 0xc000056e60)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/server/service/lproto_service.go:45 +0x67
github.com/rockin0098/flash/server/service.(*LProtoService).MakeLProtoContext(0x1946c60, 0xc00000c040, 0xc0002d4020, 0x13feb60, 0xc000030070)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/server/service/lproto_service.go:28 +0x63
github.com/rockin0098/flash/server/process.GateProcess(0xc0000fc1e0, 0xc000056f58, 0x102a492)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/server/process/gate_process.go:16 +0xef
github.com/rockin0098/flash/server/gateserver.(*TTcpServer).ConnectionHandler.func2.1()
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/server/gateserver/tcp_server.go:105 +0x37
github.com/rockin0098/flash/base/grmon.(*TGRMon).Go.func1(0x19210b8, 0x14786bd, 0xa, 0x0, 0x0, 0x0, 0x13bace0, 0xc0000b08c0)
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/base/grmon/grmon.go:46 +0xd0
created by github.com/rockin0098/flash/base/grmon.(*TGRMon).Go
	/Users/dev/workspace/golang/gopath/src/github.com/rockin0098/flash/base/grmon/grmon.go:37 +0x95